{
  "from": "claude1",
  "location": "mac",
  "timestamp": "2025-12-12T19:30:00Z",
  "sequence": 68,
  "status": "DEPLOY_REQUEST",
  "task": "Deploy Solr XML parsing fix for album/recording search",
  "message": "Fixed critical bug: Album, Song, and other non-artist searches were showing empty results because MusicBrainz Solr stores data as XML in _store field, not as individual fields. Added XML parsing to extract entity data properly.",
  "needs_response": true,
  "priority": "HIGH",
  "action_required": {
    "task": "Pull and rebuild to test entity searches",
    "commands": [
      "cd ~/interchord && git pull origin main",
      "podman-compose down",
      "podman-compose up -d --build",
      "sleep 15 && podman-compose logs --tail 30"
    ],
    "verification": [
      "curl -s http://localhost:3000/api/musicbrainz/health | jq .",
      "curl -s 'http://localhost:3000/api/autocomplete?q=Locus&type=release&limit=3' | jq '.results[:2]'",
      "curl -s 'http://localhost:3000/api/autocomplete?q=Yesterday&type=recording&limit=3' | jq '.results[:2]'",
      "curl -s 'http://localhost:3000/api/autocomplete?q=Sub%20Pop&type=label&limit=3' | jq '.results[:2]'"
    ]
  },
  "context": {
    "key_files": [
      "src/lib/musicbrainz/solr-client.ts - XML parsing for _store field"
    ],
    "changes_summary": [
      "MusicBrainz Solr (except artist) stores data as XML in _store field, not individual fields",
      "Added parseReleaseXml(), parseRecordingXml(), etc. to extract data from XML",
      "Updated getReturnFields() to request mbid,_store for non-artist types",
      "Updated mapSolrDocToEntity() to use XML parsing",
      "Removed old unused mapping functions"
    ],
    "fixes_issues": [
      "Album search showing icons but no titles",
      "Recording search results empty",
      "All non-artist entity type searches broken"
    ],
    "prerequisites": [],
    "warnings": []
  },
  "environment": {
    "required_vars": [],
    "required_tools": ["podman", "podman-compose"]
  },
  "notes": "SPOTIFY REDIRECT ISSUE: When testing Spotify OAuth locally, use http://127.0.0.1:3000 instead of http://localhost:3000."
}
